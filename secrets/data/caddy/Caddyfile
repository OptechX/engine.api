{
    # Global options block. Entirely optional, https is on by default
    # Optional email key for lets encrypt
    email hello@repasscloud.com
    # Optional staging lets encrypt for testing. Comment out for production.
    # acme_ca https://acme-staging-v02.api.letsencrypt.org/directory
}
prod.optechx-data.com {
    reverse_proxy nginx:80
    header {
        # enable HSTS
        Strict-Transport-Security max-age=31536000;
        # disable clients from sniffing the media type
        X-Content-Type-Options nosniff
        # clickjacking protection
        X-Frame-Options DENY
        # keep referrer data off of HTTP connections
        Referrer-Policy no-referrer-when-downgrade
        # Content-Security-Policy: default-src 'self'
    }
}
www.prod.optechx-data.com {
    redir https://prod.optechx-data.com{uri}
}
users.api.prod.optechx-data.com {
    reverse_proxy api-users:4000
    header {
        # enable HSTS
        Strict-Transport-Security max-age=31536000;
        # disable clients from sniffing the media type
        X-Content-Type-Options nosniff
        # clickjacking protection
        X-Frame-Options DENY
        # keep referrer data off of HTTP connections
        Referrer-Policy no-referrer-when-downgrade
        # Content-Security-Policy: default-src 'self'
    }
}
www.users.api.prod.optechx-data.com {
    redir https://users.api.prod.optechx-data.com{uri}
}
engine.api.prod.optechx-data.com {
    reverse_proxy api-engine:5000
    header {
        # enable HSTS
        Strict-Transport-Security max-age=31536000;
        # disable clients from sniffing the media type
        X-Content-Type-Options nosniff
        # clickjacking protection
        X-Frame-Options DENY
        # keep referrer data off of HTTP connections
        Referrer-Policy no-referrer-when-downgrade
        # Content-Security-Policy: default-src 'self'

        Access-Control-Allow-Origin *
        Access-Control-Allow-Credentials true
        Access-Control-Allow-Methods "OPTIONS,HEAD,GET,POST,PUT,PATCH,DELETE"
        Access-Control-Allow-Headers *
    }
}
www.engine.api.prod.optechx-data.com {
    redir https://engine.api.prod.optechx-data.com{uri}
}